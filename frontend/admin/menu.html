<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Men√∫ Principal - Admin - RHM</title>
    <link rel="stylesheet" href="../styles/main.css">
</head>
<body>
    <div class="container">
        <div class="menu-card">
            <!-- Header -->
            <div class="card-header">
                <button class="btn-back" onclick="volver()">‚Üê</button>
                <div class="header-content">
                    <div class="header-icon">üìã</div>
                    <h1>Men√∫ Principal</h1>
                </div>
            </div>

            <!-- Men√∫ de opciones -->
            <div class="menu-options">
                <button class="menu-btn" onclick="irA('asistencia')">
                    <div class="menu-btn-icon">üìä</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Asistencia</div>
                        <div class="menu-btn-description">Ver y gestionar registros de asistencia</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('empleados')">
                    <div class="menu-btn-icon">üë•</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Empleados</div>
                        <div class="menu-btn-description">Gestionar empleados y descuentos</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('sueldos')">
                    <div class="menu-btn-icon">üí∞</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Sueldos</div>
                        <div class="menu-btn-description">Calcular y gestionar sueldos</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('vacaciones')">
                    <div class="menu-btn-icon">üèñÔ∏è</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Vacaciones</div>
                        <div class="menu-btn-description">Gestionar vacaciones de empleados</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('pagos')">
                    <div class="menu-btn-icon">üí≥</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Pagos</div>
                        <div class="menu-btn-description">Historial de pagos realizados</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('uniformes')">
                    <div class="menu-btn-icon">üëî</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Uniformes y Botas</div>
                        <div class="menu-btn-description">Control de entregas</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('induccion')">
                    <div class="menu-btn-icon">üìö</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Inducci√≥n y Cursos</div>
                        <div class="menu-btn-description">Lista de empleados con cargos</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>

                <button class="menu-btn" onclick="irA('bonos-geocycle')">
                    <div class="menu-btn-icon">üéØ</div>
                    <div class="menu-btn-content">
                        <div class="menu-btn-title">Bonos GeoCycle</div>
                        <div class="menu-btn-description">Registro de producci√≥n y c√°lculo de bonos</div>
                    </div>
                    <div class="menu-btn-arrow">‚Üí</div>
                </button>
            </div>
        </div>
    </div>

    <!-- Notificaci√≥n de cortes autom√°ticos -->
    <div id="notificacionCortes" class="notificacion-cortes" style="display: none;">
        <div class="notificacion-header">
            <span class="notificacion-icon">‚ö†Ô∏è</span>
            <h3>Cortes Autom√°ticos Recientes</h3>
            <button class="notificacion-cerrar" onclick="cerrarNotificacionCortes()">√ó</button>
        </div>
        <div class="notificacion-body" id="notificacionCortesBody">
            <div class="loading">Cargando...</div>
        </div>
    </div>

    <script src="../js/theme.js"></script>
    <script src="../js/config.js"></script>
    <script>
        // Cargar notificaciones de cortes autom√°ticos al iniciar
        document.addEventListener('DOMContentLoaded', function() {
            cargarCortesAutomaticos();
        });

        // Cargar cortes autom√°ticos
        async function cargarCortesAutomaticos() {
            try {
                const apiURL = window.API_CONFIG ? window.API_CONFIG.getBaseURL() : 'http://localhost:3000';
                const response = await fetch(`${apiURL}/api/asistencia/cortes-automaticos`);
                const data = await response.json();

                if (data.success && data.data && data.data.length > 0) {
                    mostrarNotificacionCortes(data.data);
                }
            } catch (error) {
                console.error('Error al cargar cortes autom√°ticos:', error);
            }
        }

        // Mostrar notificaci√≥n de cortes autom√°ticos
        function mostrarNotificacionCortes(cortes) {
            const notificacion = document.getElementById('notificacionCortes');
            const body = document.getElementById('notificacionCortesBody');
            
            let html = `<p style="margin-bottom: 1rem; color: var(--text-secondary);">
                Se encontraron <strong>${cortes.length}</strong> empleado(s) con corte autom√°tico en las √∫ltimas 24 horas:
            </p>`;
            
            html += '<div class="cortes-lista">';
            cortes.forEach(corte => {
                html += `
                    <div class="corte-item">
                        <div class="corte-empleado">
                            <strong>${corte.nombre} ${corte.apellido}</strong>
                            <span class="corte-codigo">C√≥digo: ${corte.codigo}</span>
                        </div>
                        <div class="corte-detalle">
                            <span class="corte-fecha">Entrada: ${corte.fecha_entrada} ${corte.hora_entrada}</span>
                            <span class="corte-fecha">Salida autom√°tica: ${corte.fecha_salida} ${corte.hora_salida}</span>
                            <span class="corte-horas">Horas trabajadas: ${corte.horas_trabajadas}h</span>
                        </div>
                    </div>
                `;
            });
            html += '</div>';
            
            body.innerHTML = html;
            notificacion.style.display = 'block';
        }

        // Cerrar notificaci√≥n
        function cerrarNotificacionCortes() {
            document.getElementById('notificacionCortes').style.display = 'none';
        }

        // Navegar a diferentes secciones
        function irA(seccion) {
            switch(seccion) {
                case 'asistencia':
                    window.location.href = 'asistencia.html';
                    break;
                case 'empleados':
                    window.location.href = 'empleados.html';
                    break;
                case 'sueldos':
                    window.location.href = 'sueldos.html';
                    break;
                case 'pagos':
                    window.location.href = 'pagos.html';
                    break;
                case 'uniformes':
                    window.location.href = 'uniformes.html';
                    break;
                case 'vacaciones':
                    window.location.href = 'vacaciones.html';
                    break;
                case 'induccion':
                    window.location.href = 'induccion.html';
                    break;
                case 'bonos-geocycle':
                    window.location.href = 'bonos-geocycle.html';
                    break;
                case 'nomina':
                    // window.location.href = 'nomina.html';
                    alert('Esta secci√≥n estar√° disponible pr√≥ximamente');
                    break;
                default:
                    console.error('Secci√≥n no reconocida:', seccion);
            }
        }

        // Volver al login
        function volver() {
            localStorage.removeItem('tipoUsuario');
            localStorage.removeItem('usuario');
            window.location.href = '../index.html';
        }
    </script>
</body>
</html>

